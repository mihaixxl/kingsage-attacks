<!DOCTYPE html>
<html lang="ro">
<head>
  <meta charset="UTF-8">
  <title>KA Attacks Viewer</title>
  <style>
    body { font-family: Arial, sans-serif; background:#111; color:#eee; margin:20px; }
    h1 { color:#ff5555; }
    table { border-collapse: collapse; width: 100%; margin-top:20px; }
    th, td { border:1px solid #444; padding:6px; text-align:left; }
    th { background:#222; }
    tr:nth-child(even) { background:#1c1c1c; }
    img { height:20px; vertical-align:middle; }
  </style>
</head>
<body>
  <h1>üìä Atacuri KingsAge</h1>
  <p>Ultimul export: <span id="lastUpdate">‚Äì</span></p>
  <table id="attacksTable">
    <thead>
      <tr>
        <th>Tip</th>
        <th>Unitate</th>
        <th>Destina»õie</th>
        <th>Origine</th>
        <th>Sosire</th>
        <th>Timp rƒÉmas</th>
      </tr>
    </thead>
    <tbody></tbody>
  </table>

  <script>
    async function loadData() {
      try {
        const url = "https://gist.githubusercontent.com/mihaixxl/0324db7bac21489f29750fc33101b40b/raw/ka_attacks.json" + "?ts=" + Date.now();
        const res = await fetch(url);
        const json = await res.json();

        document.getElementById("lastUpdate").textContent =
          new Date(json.exportatLa).toLocaleString();

        const tbody = document.querySelector("#attacksTable tbody");
        tbody.innerHTML = "";

        json.data.forEach(atac => {
          const tr = document.createElement("tr");
          tr.innerHTML = `
            <td>${atac.tip}</td>
            <td>${atac.unitImg ? `<img src="${atac.unitImg}">` : ""} ${atac.unit || ""}</td>
            <td>${atac.destin}</td>
            <td>${atac.origine}</td>
            <td>${atac.sosire}</td>
            <td>${atac.ramas}</td>
          `;
          tbody.appendChild(tr);
        });
      } catch (e) {
        console.error("‚ùå Eroare √ÆncƒÉrcare JSON:", e);
      }
    }

    // √ÆncarcƒÉ imediat »ôi apoi la fiecare 10 secunde
    loadData();
    setInterval(loadData, 10000);
  </script>
</body>
</html>